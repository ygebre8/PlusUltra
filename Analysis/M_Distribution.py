import numpy as np
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import seaborn as sns
import matplotlib.colors as colors
from mpl_toolkits.mplot3d import axes3d
from matplotlib import style
style.use('ggplot')

if True :
    
    m_values = [-13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]

    K2 = popn_800 = [1.5699059696324863e-20, 3.236370447235308e-19, 3.6798639864989552e-14, 1.2279544070489918e-12, 1.5589699518499476e-10, 1.1353623575408477e-08, 5.6893428682442927e-07, 3.1201753158691258e-06, 2.8728595611254331e-05, 2.6291231787872583e-05, 2.8584332351931958e-05, 1.8470491618238321e-05, 7.2242316418186515e-06, 1.1843861959092906e-06, 2.0719633146080798e-07, 2.0242666636822098e-08, 1.8123918881062701e-10, 3.1630716057657561e-12, 5.1752185257021974e-15, 1.6349087073754046e-18, 4.9776377910281199e-22, 3.3503233891051207e-25, 3.849242208585248e-28, 1.7441944295282202e-28, 1.0456096235199342e-31, 1.315198748773211e-30, 9.4079814813935234e-33]
    popn_800_con = [1.5699005831599083e-20, 3.2363672190381533e-19, 3.6798641184384603e-14, 1.2279543998012969e-12, 1.5589699857462504e-10, 1.1353623522159276e-08, 5.6893428783413882e-07, 3.1201753155374438e-06, 2.8728595553174562e-05, 2.6291231861766331e-05, 2.8584332372821393e-05, 1.847049161374991e-05, 7.2242316443789357e-06, 1.1843861988099761e-06, 2.0719633165522613e-07, 2.0242666787843358e-08, 1.8123919795162426e-10, 3.1630701548575057e-12, 5.1752283342789494e-15, 1.6345807149151513e-18, 4.9531195196316775e-22, 3.0637360549315622e-25, 2.716215391893828e-28, 1.7549049710138622e-28, 1.1633522215944237e-31, 1.3145864927422531e-30, 9.411160038078122e-33]
    popn_1068 = [3.4020784134343122e-19, 1.5961409388361523e-15, 2.9007303000456631e-14, 6.0464094165796055e-12, 1.0609446240191432e-09, 3.4964501263564384e-09, 7.1070910942267604e-07, 1.3772209245485792e-06, 2.3486573976875138e-06, 4.2167713050110864e-06, 5.4401296406467611e-06, 2.8374708254054699e-06, 1.375707185440269e-06, 4.4890442039811422e-07, 5.5889820576845367e-08, 3.2801779622415914e-08, 2.0774205781604377e-09, 3.2638922789623577e-10, 1.9948136597894149e-12, 9.9258446825208748e-15, 1.4584178102521351e-15, 2.7476392935899244e-19, 2.2758927574768196e-21, 2.0744583030669155e-24, 1.1978818853955038e-27, 7.3770974720323925e-29, 4.1581703826535316e-31]
    popn_1068_con =  [3.3783937677089343e-19, 1.5971932043446485e-15, 2.899175599619943e-14, 6.0460648819029589e-12, 1.060945517875665e-09, 3.4964504441898412e-09, 7.1070919105020377e-07, 1.377220601988951e-06, 2.3486573545303177e-06, 4.2167713488204351e-06, 5.4401299370271274e-06, 2.8374708295516869e-06, 1.3757071801520441e-06, 4.4890439916019053e-07, 5.5889819845361604e-08, 3.2801778182734805e-08, 2.0774205697703543e-09, 3.2638921142085165e-10, 1.9948066839466613e-12, 9.9254107222715908e-15, 1.458382515672073e-15, 2.7478915107394644e-19, 2.2766149577872502e-21, 1.9853440785483809e-24, 3.2887907974359513e-28, 3.0723436623439785e-30, 9.4960346240259036e-32]

    P6 = popn_0 = [7.431505275800436e-29, 1.978806798146662e-28, 1.6643436151597324e-26, 5.322711337841579e-21, 6.60490080616548e-16, 2.622632499088349e-11, 2.132873255472816e-07, 4.301812768196864e-05, 6.811751587967962e-05, 0.0005404215628867606, 0.00023631386163315056, 3.560195088551102e-05, 7.803393225153498e-06, 2.46444358998536e-07, 6.615015819993015e-10, 4.908765290416456e-12, 3.414971526995831e-15, 1.905834326247558e-19, 1.794496089869951e-24, 1.4284363120796068e-25, 6.868944464614689e-23, 1.5688146252529187e-26, 5.761949658807024e-28, 5.405991612740657e-32, 1.123053210684946e-33, 1.0824596486418471e-34, 4.193734465050869e-36]
    P5 = popn_neg_2 = [1.562878663178963e-27, 1.6874115303044954e-26, 1.8990825901344683e-26, 6.941261861665712e-22, 2.005378271723981e-16, 1.6136214533884072e-11, 2.4880195307638e-07, 2.5498752735339333e-05, 0.0001031048955254636, 0.00024344068736946038, 0.0002576522542950783, 3.2595129393349905e-05, 1.2744003877399622e-05, 4.4298192431471097e-07, 2.747822219329101e-09, 4.8635045229411864e-12, 3.216527156190625e-15, 6.583388860289672e-19, 1.7596347817547955e-22, 5.865975532954968e-26, 1.4011108105713925e-29, 6.350531114951599e-31, 2.6735308991832373e-31, 4.540458239252761e-32, 2.6469086793572508e-33, 9.753902049309541e-35, 2.8075212520872007e-37]
    P4 = popn_neg_4 = [6.595160447449104e-29, 7.009097319459665e-28, 6.86706169150031e-28, 2.0739983605414224e-24, 3.547691604603259e-18, 1.9023647255057586e-12, 2.1993793660718352e-07, 9.302629857082942e-07, 1.4671059782001465e-05, 0.00041764489150032593, 0.004031628360427812, 4.746336225752959e-05, 6.988254557686171e-07, 1.3054611464957417e-08, 2.2892465058141916e-10, 3.405851361372356e-13, 7.518986679695326e-15, 5.346623478321426e-17, 1.6929467512607975e-19, 2.6834625959196837e-22, 2.222088435596572e-25, 9.770414347232428e-29, 2.971405879007053e-31, 2.2879294516976648e-33, 8.472505668988661e-36, 9.351778031473286e-38, 8.009279212345739e-39]
    P3 = popn_neg_6 = [6.830359013262478e-34, 7.094788012253717e-32, 3.148928299588e-30, 3.8008367256465685e-26, 2.529009223688291e-19, 5.567215079782555e-13, 2.1567297816405647e-07, 3.4970776479695044e-08, 1.1506136397401311e-06, 1.2990915823396836e-05, 0.005857840535055251, 6.86402894285451e-07, 9.431276645720669e-09, 1.9507756103248968e-10, 6.703990283004454e-11, 2.286444892114656e-13, 7.665051388263414e-15, 5.1923469730163304e-17, 1.4997489400064306e-19, 2.1838757231436926e-22, 2.060068016673731e-23, 3.0230303558195195e-26, 1.1889239171864372e-28, 3.4030816008509084e-32, 1.3910633632360627e-34, 7.113620577413093e-38, 5.720477243662302e-39]
    P2 = popn_neg_8 = [1.8475016065615603e-33, 2.857600468587021e-32, 1.1068435475385856e-30, 3.2557908986731885e-26, 2.5009337386831883e-19, 5.537321687193001e-13, 2.1608295927489123e-07, 3.2253813316077996e-08, 9.26451811101816e-12, 2.0860981575811176e-08, 0.005396073652434839, 5.364975416010929e-08, 6.446657402599483e-10, 1.7689354336924058e-10, 4.875911409294831e-11, 5.585892580893407e-14, 2.4120903831451644e-16, 2.0275663216602754e-19, 7.277163153295468e-23, 1.3834316643920378e-26, 2.809958424346823e-30, 9.555667653568485e-34, 3.1410608200087805e-35, 2.1357013612579834e-36, 1.2247241421844576e-36, 5.92933156872573e-39, 8.006286209661254e-39]
    P1 = popn_neg_10 = [1.17458689800793e-33, 3.0765864031055586e-32, 8.264955457250962e-31, 3.454151024430812e-26, 2.500062745251474e-19, 5.537320049217097e-13, 2.1608301126685943e-07, 3.224992418477269e-08, 7.491221532430217e-12, 1.501195505625421e-08, 0.005404817666593404, 5.11105538904807e-08, 1.3535501661926527e-09, 1.4892447111540391e-10, 5.824914182750867e-11, 7.205838039509109e-16, 2.9846624645317337e-21, 8.988079508683744e-20, 4.8216207612889135e-26, 1.080022234837715e-28, 1.6897949338884435e-30, 4.716949988992867e-33, 1.0811301707063409e-36, 7.159674440058827e-37, 4.567851177848211e-37, 2.7258285133399928e-39, 5.544061580851181e-39]
    
    popn_2 = [6.663042218375805e-29, 1.209169740955664e-27, 1.1016991156042923e-26, 2.7658750545405958e-21, 4.787094628038761e-16, 2.454984903053922e-11, 2.332806670633657e-07, 4.117555704365748e-05, 1.8539837210121433e-05, 0.0008374851510612336, 0.00041552703926995947, 6.875780415018763e-05, 1.64434639392097e-05, 4.478815335622914e-07, 2.5418503546007694e-09, 3.0541600974935095e-12, 2.3723318491184094e-15, 1.0858940764053012e-19, 8.473500572597315e-25, 8.166661942564524e-29, 9.936122528985556e-30, 2.041336916153337e-31, 5.308914718018268e-32, 1.0039706187676849e-32, 1.4438524509165988e-33, 9.413446430241128e-35, 3.87159310720451e-36]
    P7 = popn_4 = [2.3991870606507886e-27, 7.259425989911592e-27, 2.5290005474751044e-27, 6.292701183956536e-22, 2.11553607242893e-16, 1.7945770629304862e-11, 2.608252821088384e-07, 2.6772464927440927e-05, 5.148547825655906e-06, 0.0010901514058948194, 0.000590658392935013, 8.230686350365825e-05, 1.6260920924755434e-05, 1.0546127492302145e-06, 5.185296088067561e-09, 1.7354466886365229e-12, 5.196159927900275e-16, 2.8140336329443867e-19, 1.0448466723321628e-22, 2.4313535940472142e-26, 2.631571484614086e-30, 3.8036165738032408e-31, 7.315346928167268e-32, 1.2095789661796228e-32, 1.2311089896509332e-33, 5.904607888344629e-35, 2.5766786579614204e-36]
    popn_6 = [1.854612761410952e-27, 6.119566885951887e-27, 1.70210870784843e-27, 6.843810818723621e-23, 4.6763929895592394e-17, 8.076902877175339e-12, 2.510218504931412e-07, 8.052017665373637e-06, 1.1459256672598416e-05, 0.0012875340301424555, 0.0009399021909475187, 6.030761696683769e-05, 1.1004373733584074e-05, 6.831598967169414e-07, 9.146053890313562e-10, 7.698845743112906e-13, 3.596277222518957e-15, 1.1217796912172546e-17, 1.6312132772084596e-20, 1.233571986946278e-23, 5.107509174267126e-27, 1.8182390444397525e-30, 5.406075595268879e-32, 6.306963731303718e-33, 5.367833124769432e-34, 1.7218565115717538e-35, 6.384731325016944e-37]
    P8 = popn_8 = [4.4336145336355306e-26, 3.593941531509454e-25, 1.9218422482231115e-25, 2.282868667602082e-24, 4.34588747045077e-18, 2.324842510388686e-12, 2.2967732302727195e-07, 8.382847166078861e-07, 1.5017241956511932e-05, 0.0008627254955377711, 0.0029451238399003784, 2.5347213040846306e-05, 1.432752998923813e-06, 9.800272379486793e-08, 1.5968840516294718e-10, 3.17646280519695e-13, 9.337990744935543e-15, 6.106482166577693e-17, 1.7662097692796766e-19, 2.594279359160251e-22, 2.0595564282406546e-25, 9.080256536813375e-29, 2.701863685796947e-32, 1.7250679070934763e-33, 1.2320332219901458e-34, 4.0137470140775456e-36, 5.672837223504012e-38]
    popn_10 = [5.179320348428333e-30, 1.059367390569789e-29, 6.469972713545974e-28, 6.257642952415531e-22, 1.765089883911039e-16, 1.5214474286291843e-11, 2.3038111288492276e-07, 2.4123185378424768e-05, 3.626581170608456e-05, 0.0009185689942063244, 0.000274587297532201, 7.664558591327648e-05, 1.9453916887645938e-05, 5.320796068957595e-07, 7.633832637104611e-09, 1.9166979760490514e-11, 1.0018661643992292e-14, 2.774104862036128e-19, 2.4725286619477745e-24, 2.5484450249244732e-26, 2.8230706503524384e-27, 2.753361470266054e-29, 1.6898337598701223e-31, 7.98411591894218e-34, 3.514583058681654e-35, 1.57339594312209e-36, 6.046678137500075e-38]
    P9 = popn_12 = [9.157591979170088e-28, 4.8654222158548036e-24, 5.071029470168968e-23, 2.8361816159041937e-23, 2.6345692560853624e-19, 5.72106591006016e-13, 2.2024353358522385e-07, 3.73620145823564e-08, 1.8480176513924559e-06, 1.4961441774809913e-05, 0.005590015258111224, 1.3054296777468512e-06, 3.5901207684322387e-09, 2.26760813963742e-10, 5.983096954352007e-11, 3.1040694865924246e-13, 8.465464051297803e-15, 5.922141919488401e-17, 1.8321462671200172e-19, 2.8484227947131125e-22, 2.361040606843544e-25, 1.0880148802457504e-28, 2.781776961570164e-32, 2.4382776218094225e-35, 3.456428196266559e-36, 1.3082235499103293e-38, 1.0594489416779943e-38]
    P10 = popn_16 = [7.570378978718586e-35, 9.276833164356406e-29, 7.60171843225098e-24, 9.245124222980498e-22, 2.543039825636121e-19, 5.507567520255906e-13, 2.2040263412092408e-07, 3.2885679246259643e-08, 7.625660127431404e-12, 1.6112213435720865e-09, 0.005513786255834876, 4.792322806650062e-09, 1.2295632510052023e-09, 1.5657455784359322e-10, 5.188667817491163e-11, 1.0430911703084209e-13, 3.780167185431453e-16, 4.002459098136572e-19, 1.9743251628929617e-22, 4.873707419560889e-26, 6.626278521531941e-30, 3.988654619453991e-34, 1.0428656127265427e-35, 3.701599920302856e-36, 2.1070586249818033e-36, 1.0708867108533489e-38, 1.224799248012045e-38]
    P11 = popn_20 = [8.231366734952567e-35, 2.015374961855947e-31, 9.199430735825177e-27, 7.596891482248257e-23, 1.9842823610814645e-19, 5.443172788590916e-13, 2.20385289566431e-07, 3.2882813598368844e-08, 7.78719043966685e-12, 2.314779296581896e-11, 0.0055091293354480745, 3.7923953690410984e-09, 1.77333766681984e-09, 1.2145692516174673e-10, 5.180303139960658e-11, 4.2668653952475984e-16, 1.7693717037569853e-21, 4.711537169495781e-27, 1.5707829403252283e-29, 3.461878378876701e-31, 2.4967645822416614e-32, 4.521627647396568e-34, 1.0820260470452577e-35, 3.5264302847516805e-36, 2.4497174261625993e-36, 1.1867427938443837e-38, 1.0209449602567142e-38]

    K1 = popn_534_length = [4.6260307408031275e-25, 2.0592531440624172e-23, 6.8763557137284614e-23, 6.90270488013315e-22, 2.97044336832905e-16, 2.5105816708681713e-11, 3.4597492274433823e-07, 7.2423446745167953e-05, 0.00012557213639558299, 0.00075123015636445424, 0.00031611761354726826, 4.948375775174409e-05, 1.5517844879593676e-05, 4.4642439520361714e-07, 1.7124571844720487e-09, 1.6702988546569568e-11, 1.6883254070888282e-14, 8.7666939506833471e-19, 5.9553390235495144e-24, 3.7842920368333316e-27, 9.1638717584625527e-29, 1.7442139641621172e-30, 6.2454671613263437e-31, 9.4960471779354138e-32, 8.9763885844327979e-34, 6.8573752112241035e-35, 1.0277727724347317e-36]
    K3 = popn_1068_length = [1.4887041925313968e-18, 1.488988578693293e-15, 4.0237354305174695e-14, 9.9630115417095214e-12, 6.5075200105302456e-10, 2.243035893840584e-08, 5.9171654315116847e-08, 2.1156416126177605e-06, 1.7062590242879077e-06, 6.6031479529255925e-06, 4.0539267650434721e-06, 3.0574046090319736e-06, 1.143503220230319e-06, 3.69692002891874e-07, 9.6693185234452738e-08, 1.135333514996828e-08, 2.36511367773009e-09, 3.3310769893617846e-10, 1.8096661116006288e-12, 2.0898657474932831e-14, 1.5534561170887078e-15, 5.4539715264819736e-19, 1.3819169468866306e-21, 9.5803517967485694e-25, 5.7262373548195634e-29, 3.6527368205401024e-31, 1.8080542124921654e-31]
    popn_1068_length_con = [1.4886673153362601e-18, 1.4889833010116328e-15, 4.0237386876906786e-14, 9.9630124637876251e-12, 6.5075200914288797e-10, 2.2430358687643976e-08, 5.9171655525374768e-08, 2.1156416043274416e-06, 1.7062590300418179e-06, 6.6031479441775735e-06, 4.0539267690669769e-06, 3.0574046000765996e-06, 1.1435032188463354e-06, 3.6969200611432943e-07, 9.6693183927669312e-08, 1.1353335155491885e-08, 2.3651137323740288e-09, 3.3310772931730144e-10, 1.8096661321928884e-12, 2.0898774713325455e-14, 1.553457904186684e-15, 5.4550361756169318e-19, 1.3831461445508849e-21, 9.5596322625033138e-25, 5.8080221655764243e-29, 3.274222402984151e-31, 1.7684450446809465e-31]

    L1 = [3.4420007000347204e-22, 1.5321884268717583e-20, 5.1163562255602361e-20, 5.1359613372189901e-19, 2.2101600110480549e-13, 1.8679996638159709e-08, 0.00025742283028446265, 0.053886705117856093, 0.093432016688979908, 0.55895320826266992, 0.23520748306443395, 0.036818416989654906, 0.01154606096052848, 0.00033216231514636636, 1.2741547036734491e-06, 1.242786775342163e-08, 1.2561994415275461e-11, 6.522863423515323e-16, 4.4310732540533878e-21, 2.8157045574787454e-24, 6.8183837883836653e-26, 1.2977833529515319e-27, 4.6469432534719912e-28, 7.0655390907198973e-29, 6.6788868303191098e-31, 5.102233772302248e-32, 7.6471489283333393e-34]
    L2 =  [1.1500560962234363e-16, 2.3708474484950545e-15, 2.6957347081984278e-10, 8.9955480075136386e-09, 1.1420447667791884e-06, 8.3172522811549962e-05, 0.004167805955067108, 0.022857271153260288, 0.21045525756167047, 0.19260001541330893, 0.2093984373185854, 0.13530811333096365, 0.052922097252415326, 0.0086763831161635295, 0.0015178450730231753, 0.00014829042388408704, 1.3276924732953694e-06, 2.3171513793617512e-08, 3.79117713410924e-11, 1.1976747410712911e-14, 3.6464366637857702e-18, 2.4543252350727131e-21, 2.8198150420820102e-24, 1.2777334919921817e-24, 7.6597563488499832e-28, 9.6346683688715062e-27, 6.8919455465009165e-29]
    L3 = [5.2864462434024921e-14, 5.2874561096773195e-11, 1.4288440348203007e-09, 3.5379039840068958e-07, 2.3108455585818894e-05, 0.00079651073291112724, 0.0021012083612000922, 0.075127253026616783, 0.060589918766069291, 0.2344803411282001, 0.14395650946378927, 0.10856962176277118, 0.040606242215427427, 0.013127906199958342, 0.0034336124557835116, 0.00040316132818557564, 8.3986102676287074e-05, 1.1828783397830523e-05, 6.4261944484865659e-08, 7.4211942073363974e-10, 5.5163828352696908e-11, 1.9367264116297381e-14, 4.9072405983762945e-17, 3.4020200265760762e-20, 2.0334090617252346e-24, 1.2971009915843266e-26, 6.4204705323254986e-27]
def Heat_Map():

    heat_map = np.zeros(shape=(11, len(m_values)))

    for i in range(1,4):
        for m in range(len(m_values)):
            heat_map[i - 1][m] = eval("K" + str(i)+ "[m]")


    limit = 5
    vmaxlog = -4.

    label = [pow(10.0, i) for i in np.arange(vmaxlog - limit, vmaxlog + 1)]
    vmax_num = pow(10, vmaxlog + 1)
    vmin_num = pow(10, vmaxlog - limit)


    figure = plt.figure()
    axes = figure.add_subplot(1,1,1)
    
    xticks = np.arange(.5, 2*np.amax(m_values) + 1, 2)
    xlabel = np.arange(-1 * np.amax(m_values), np.amax(m_values) + 1, 2)

    yticks = np.arange(.5, 4, 1)
    ylabel = [534, 800, 1068]


    axes = sns.heatmap(heat_map, norm=colors.LogNorm(), yticklabels=ylabel, xticklabels=xlabel, linewidths=.1, 
    cmap="plasma", annot=False, cbar_kws={"ticks":label},  vmin=vmin_num, vmax=vmax_num)

    plt.xticks(xticks)
    plt.yticks(yticks)

    plt.xlabel('m', fontsize=18)
    plt.ylabel('Wavelength in nm', fontsize=18)

    plt.ylim(0, 3)
    plt.xlim(2, 19)

    plt.savefig("Heat_Map_HWL.png")
    plt.clf()

def Bar_Plot():
    fig = plt.figure()
    ax1 = fig.add_subplot(111, projection='3d')

    x = [-13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
    x = x[5:13] 

    colors = plt.cm.jet(np.array(P6[5:13])/float(np.array(P6).max()))

    for i in range(1, 4):
        y = np.zeros(len(x)) + i 
        z = np.zeros(len(x))

        dx = np.ones(len(x)) - 0.4
        dy = np.ones(len(x)) - 0.2
        dz = eval("L" + str(i) + "[5:13]")

        ax1.bar3d(x, y, z, dx, dy, dz)
        
    
    ax1.view_init(elev=45,azim=45)
    
    ticks = [pow(10,x) for x in range(-2, -5)]
    
    # ax1.set_zticks(ticks)
    # ax1.set_zlim3d(pow(10,-5)*1.2, pow(10,-2.5))

    ax1.set_xlabel('m value')
    ax1.set_ylabel('delay ')
    ax1.set_zlabel('z axis')
    
  
    plt.savefig("Heat_Map.png")
    plt.clf()
            

if __name__=="__main__":


    Heat_Map()
    # Bar_Plot()
    # f = plt.figure()
    # ax = f.add_subplot(111)
    # ax.yaxis.tick_right()
    # ax.grid(color = "gray", linestyle='dotted', linewidth=2, axis='y', alpha=0.3)
    # ax.tick_params(direction='out', length=8, width=1.2,which='major')
    # ax.tick_params(direction='out', length=3, width=1,which='minor')


    # #plt.bar(m_values, popn_1068_length, align='center', alpha=1, log = True, color = 'darkblue', edgecolor='magenta')
   
    # plt.ylim(pow(10,-9)*1.2, 1.2*pow(10,-4))
    # xticks = m_values
    # xlabel = m_values

    # plt.ylabel("Probability", fontsize=18)


    # plt.xticks(xticks, fontsize = 12)
    # plt.yticks(fontsize = 15)

    # plt.xlim(-8.5,3.5)

    # plt.savefig("M_1068_Length.png")